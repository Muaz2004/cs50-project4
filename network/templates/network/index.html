{% extends "network/layout.html" %}
{% block body %}

<!-- Page Info -->
<div class="mb-6 text-center">
    <h2 class="text-2xl font-bold mb-2">Welcome to Your Feed</h2>
    <p class="text-gray-600 dark:text-gray-400">
        See what people you follow are posting. Like ❤️ posts and share your thoughts!
    </p>
</div>

<!-- New Post -->
{% if user.is_authenticated %}
<div class="mb-6 flex justify-center">
    <form action="{% url 'newpost' %}" method="post" class="w-full max-w-xl bg-gray-50 dark:bg-[#1E293B] p-5 rounded-xl shadow-lg flex flex-col gap-3 border border-gray-200 dark:border-gray-700 transition-colors duration-300">
        {% csrf_token %}
        <textarea name="content" placeholder="Share something with the network..." class="w-full p-3 rounded-lg border border-gray-300 dark:border-gray-600 dark:bg-[#0F172A] dark:text-gray-100 focus:ring-2 focus:ring-[#0EA5E9] transition-colors duration-300"></textarea>
        <div class="flex justify-between items-center">
            <small class="text-gray-500 dark:text-gray-400">Max 280 characters</small>
            <button type="submit" class="bg-[#0EA5E9] text-white px-4 py-2 rounded-lg hover:bg-[#0284C7] transition">Post</button>
        </div>
    </form>
</div>
{% endif %}

<!-- Posts -->
<div class="flex flex-col gap-4">
    {% for i in query %}
    <div class="bg-white dark:bg-[#1E293B] p-4 rounded-lg shadow-md border border-gray-200 dark:border-gray-700 transition-colors duration-300">
        <div class="flex justify-between items-start">
            <a href="{% url 'profile' i.creator.id %}" class="font-bold text-[#0EA5E9] hover:underline">{{ i.creator.username }}</a>
            <small class="text-gray-500 dark:text-gray-400">{{ i.timestamp }}</small>
        </div>
        <p class="mt-2">{{ i.newpost }}</p>

        <!-- Like button -->
        <form action="{% url 'like' i.id %}" method="post" class="mt-3">
            {% csrf_token %}
            <input type="hidden" name="post_id" value="{{ i.id }}">
            <button type="submit" class="text-2xl focus:outline-none transition-colors duration-200
                {% if user in i.liked_by.all %}text-red-500{% else %}text-gray-400 dark:text-gray-300{% endif %}">
                ❤️
            </button>
            <span class="ml-2 text-sm text-gray-600 dark:text-gray-400">{{ i.likes }}</span>
        </form>
    </div>
    {% empty %}
    <p class="text-center text-gray-500 dark:text-gray-400">No posts yet. Start by sharing something!</p>
    {% endfor %}
</div>

<!-- Pagination -->
<div class="mt-6 flex justify-center">
    <nav>
        <ul class="flex gap-1">
            {% if query.has_previous %}
            <li>
                <a href="?page={{ query.previous_page_number }}" class="px-3 py-1 rounded-md bg-[#0EA5E9] text-white hover:bg-[#0284C7]">Prev</a>
            </li>
            {% endif %}
            {% for page_num in query.paginator.page_range %}
                {% if query.number == page_num %}
                <li><span class="px-3 py-1 rounded-md bg-gray-300 dark:bg-gray-600">{{ page_num }}</span></li>
                {% else %}
                <li><a href="?page={{ page_num }}" class="px-3 py-1 rounded-md hover:bg-gray-200 dark:hover:bg-gray-700">{{ page_num }}</a></li>
                {% endif %}
            {% endfor %}
            {% if query.has_next %}
            <li>
                <a href="?page={{ query.next_page_number }}" class="px-3 py-1 rounded-md bg-[#0EA5E9] text-white hover:bg-[#0284C7]">Next</a>
            </li>
            {% endif %}
        </ul>
    </nav>
</div>

{% endblock %}
