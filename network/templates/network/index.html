{% extends "network/layout.html" %}
{% block body %}

<!-- New Post -->
<div class="mb-6">
    {% if user.is_authenticated %}
    <form action="{% url 'newpost' %}" method="post" class="flex flex-col gap-2 bg-white dark:bg-[#1E293B] p-4 rounded-md shadow-md">
        {% csrf_token %}
        <textarea name="content" placeholder="What's on your mind?" class="border rounded-md p-2 w-full dark:bg-[#0F172A] dark:text-gray-100"></textarea>
        <button type="submit" class="bg-[#0EA5E9] text-white px-4 py-2 rounded-md w-32 hover:bg-[#0284C7]">Post</button>
    </form>
    {% endif %}
</div>

<!-- Posts -->
<div class="flex flex-col gap-4">
    {% for i in query %}
    <div class="bg-white dark:bg-[#1E293B] p-4 rounded-md shadow-md">
        <a href="{% url 'profile' i.creator.id %}" class="font-bold text-[#0EA5E9] hover:underline">{{ i.creator.username }}</a>
        <p class="mt-1">{{ i.newpost }}</p>
        <small class="text-gray-500 dark:text-gray-400">{{ i.timestamp }}</small>

        <!-- Like button -->
        <form action="{% url 'like' i.id %}" method="post" class="mt-2">
            {% csrf_token %}
            <input type="hidden" name="post_id" value="{{ i.id }}">
            <button class="like-button px-3 py-1 rounded-md hover:bg-[#0284C7] bg-gray-100 dark:bg-gray-700 text-gray-800 dark:text-gray-200">
                ❤️ {{ i.likes }}
            </button>
        </form>
    </div>
    {% empty %}
    <p class="text-center text-gray-500 dark:text-gray-400">No posts yet.</p>
    {% endfor %}
</div>

<!-- Pagination -->
<div class="mt-6 flex justify-center">
    <nav>
        <ul class="flex gap-1">
            {% if query.has_previous %}
            <li><a href="?page={{ query.previous_page_number }}" class="px-3 py-1 rounded-md bg-[#0EA5E9] text-white hover:bg-[#0284C7]">Prev</a></li>
            {% endif %}
            {% for page_num in query.paginator.page_range %}
                {% if query.number == page_num %}
                <li><span class="px-3 py-1 rounded-md bg-gray-300 dark:bg-gray-600">{{ page_num }}</span></li>
                {% else %}
                <li><a href="?page={{ page_num }}" class="px-3 py-1 rounded-md hover:bg-gray-200 dark:hover:bg-gray-700">{{ page_num }}</a></li>
                {% endif %}
            {% endfor %}
            {% if query.has_next %}
            <li><a href="?page={{ query.next_page_number }}" class="px-3 py-1 rounded-md bg-[#0EA5E9] text-white hover:bg-[#0284C7]">Next</a></li>
            {% endif %}
        </ul>
    </nav>
</div>

{% endblock %}
